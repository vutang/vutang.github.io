
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://www.vutang.github.io/lnx_ldd/audio/linux_audio/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.2">
    
    
      
        <title>Audio - Vu Tang's Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#audio-in-linux" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Vu Tang&#39;s Docs" class="md-header__button md-logo" aria-label="Vu Tang's Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vu Tang's Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Audio
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Vu Tang&#39;s Docs" class="md-nav__button md-logo" aria-label="Vu Tang's Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Vu Tang's Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        General Technote
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="General Technote" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          General Technote
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../technote/mkdocs/mkdocs-notes/" class="md-nav__link">
        Mkdocs Tool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../technote/markdown/markdown/" class="md-nav__link">
        Markdown Language
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../technote/shellscript/shellscript/" class="md-nav__link">
        Shell Script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../technote/python/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../technote/virutal_machine/virtual_box.md" class="md-nav__link">
        Virtual Machine
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Book & Materials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Book & Materials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Book & Materials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/c_books/" class="md-nav__link">
        C Programing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/linux/" class="md-nav__link">
        Linux Programing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/device_driver/" class="md-nav__link">
        Linux Device Driver
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/linux_kernel/" class="md-nav__link">
        Linux Kernel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/es_linux/" class="md-nav__link">
        Linux Embedded
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/dsa/dsa_toc/" class="md-nav__link">
        Data Structure & Algorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../books/others/" class="md-nav__link">
        Others
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Programming
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Programming" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Programming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/C/cprogramming/" class="md-nav__link">
        C
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/dsa/dsa/" class="md-nav__link">
        DSA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/sql/mysql/" class="md-nav__link">
        SQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/lnx/lpi/" class="md-nav__link">
        Linux Programming Interfaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/dsg_patterns/" class="md-nav__link">
        Design Patterns
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/multi-threaded-programming/" class="md-nav__link">
        Multi-threads
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../programming/perf/perf/" class="md-nav__link">
        Perf
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Linux General
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux General" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Linux General
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx/linux/" class="md-nav__link">
        Unsorted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx/cmds/" class="md-nav__link">
        Commands
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Linux ES Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux ES Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Linux ES Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/es/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/hw_platform/" class="md-nav__link">
        HW Platforms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/cmn_tool/" class="md-nav__link">
        Common Tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/version_control/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/ptlnx/" class="md-nav__link">
        Xilinx Petalinux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/yocto/" class="md-nav__link">
        Yocto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/eeprom/eeprom/" class="md-nav__link">
        EEPROM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_es/tips/tips/" class="md-nav__link">
        Tips
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" checked>
      
      <label class="md-nav__link" for="__nav_7">
        Linux Device Driver
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux Device Driver" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Linux Device Driver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../kernel_module/" class="md-nav__link">
        Kernel Module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../platform_dev/platform_device/" class="md-nav__link">
        Platform Device
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../spi_dev/spi_dev/" class="md-nav__link">
        SPI Device
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../spi_dev/spi_advance/" class="md-nav__link">
        SPI Device Advance
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../gpio/gpio/" class="md-nav__link">
        GPIO
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../uart/uart/" class="md-nav__link">
        UART
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../jesd/jesd/" class="md-nav__link">
        JESD
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Audio
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Audio
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#alsa" class="md-nav__link">
    ALSA
  </a>
  
    <nav class="md-nav" aria-label="ALSA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alsa-concept" class="md-nav__link">
    ALSA concept
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asoc" class="md-nav__link">
    ASoC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alsa-application" class="md-nav__link">
    ALSA Application
  </a>
  
    <nav class="md-nav" aria-label="ALSA Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arecord-aplay" class="md-nav__link">
    arecord &amp; aplay
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dapm-dynamic-audio-power-management" class="md-nav__link">
    DAPM - Dynamic Audio Power Management
  </a>
  
    <nav class="md-nav" aria-label="DAPM - Dynamic Audio Power Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-dapm" class="md-nav__link">
    What is DAPM?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-dapm-works" class="md-nav__link">
    How DAPM works?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-wm8960" class="md-nav__link">
    Case Study - WM8960
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-interface-definitions" class="md-nav__link">
    Physical interface definitions
  </a>
  
    <nav class="md-nav" aria-label="Physical interface definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#i2s-inter-ic-sound" class="md-nav__link">
    I2S - Inter IC Sound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sai-synchronous-audio-interface" class="md-nav__link">
    SAI - Synchronous Audio Interface
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dai-digital-audio-interfaces" class="md-nav__link">
    DAI - Digital Audio Interfaces
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../pcie/pcie/" class="md-nav__link">
        PCIe
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Linux Kernel Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux Kernel Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Linux Kernel Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_kernel/kernel_data_structure/" class="md-nav__link">
        Kernel Data Structure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../lnx_kernel/kernel_user_space/" class="md-nav__link">
        Kernel Space, User Space Interfaces
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        FPGA
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FPGA" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          FPGA
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../fpga/timing_analysis/timing_analysis/" class="md-nav__link">
        Static Timing Analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../fpga/x_ipcore/xipcore/" class="md-nav__link">
        Xilinx IPCore
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      <label class="md-nav__link" for="__nav_10">
        Projects
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Projects" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Projects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../projects/zynq/zynq/" class="md-nav__link">
        Zynq
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../projects/imx8/imx8/" class="md-nav__link">
        IMX8
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../projects/pi3b/" class="md-nav__link">
        Raspberrypi 3B
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../bookmarks/bookmarks/" class="md-nav__link">
        Bookmarks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../whatnext/" class="md-nav__link">
        What's next
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../about/about/" class="md-nav__link">
        About me
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#alsa" class="md-nav__link">
    ALSA
  </a>
  
    <nav class="md-nav" aria-label="ALSA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alsa-concept" class="md-nav__link">
    ALSA concept
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#asoc" class="md-nav__link">
    ASoC
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alsa-application" class="md-nav__link">
    ALSA Application
  </a>
  
    <nav class="md-nav" aria-label="ALSA Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#arecord-aplay" class="md-nav__link">
    arecord &amp; aplay
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dapm-dynamic-audio-power-management" class="md-nav__link">
    DAPM - Dynamic Audio Power Management
  </a>
  
    <nav class="md-nav" aria-label="DAPM - Dynamic Audio Power Management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-dapm" class="md-nav__link">
    What is DAPM?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-dapm-works" class="md-nav__link">
    How DAPM works?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-study-wm8960" class="md-nav__link">
    Case Study - WM8960
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physical-interface-definitions" class="md-nav__link">
    Physical interface definitions
  </a>
  
    <nav class="md-nav" aria-label="Physical interface definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#i2s-inter-ic-sound" class="md-nav__link">
    I2S - Inter IC Sound
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sai-synchronous-audio-interface" class="md-nav__link">
    SAI - Synchronous Audio Interface
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dai-digital-audio-interfaces" class="md-nav__link">
    DAI - Digital Audio Interfaces
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="audio-in-linux">Audio in Linux</h1>
<h2 id="alsa">ALSA</h2>
<p><a href="https://alsa-project.org/wiki/Main_Page">Advanced Linux Sound Architecture (ALSA)</a> is a software framework and part of the Linux kernel that provides an application programming interface (API) for sound card device drivers. </p>
<p>The project to develop ALSA was led by Jaroslav Kysela, and it started in 1998 and was developed separately from the Linux kernel until it was introduced in the 2.5 development series in 2002. In the 2.6 version, ALSA replaced the previous system, <strong>Open Sound System (OSS)</strong>, by default (although a backwards-compatibility layer does exist).</p>
<p><img alt="asla-lnx-blockdiagram" src="../imgs/alsa-linux-bd.png" /></p>
<p><em>Figure. A block diagram for ALSA in Linux</em></p>
<h3 id="alsa-concept">ALSA concept</h3>
<p><em>*TBD</em></p>
<h3 id="asoc">ASoC</h3>
<p>The ASoC (ALSA System on Chip) layer aims to provide better support for ALSA on embedded systems that use a system-on-chip (SoC) design.</p>
<p>The codec class driver is platform independent and contains audio controls, audio interface capabilities, codec DAPM
definition and codec IO functions.</p>
<p>The platform class driver includes the audio DMA engine driver, digital audio interface (DAI) drivers (e.g. I2S, AC97, PCM) and any audio DSP drivers for that platform.</p>
<p>The machine driver class acts as the glue that describes and binds the other component drivers together to form an ALSA "sound card device". It handles any machine specific controls and machine level audio events (e.g. turning on an amp at start of playback).</p>
<p><a href="https://01.org/linuxgraphics/gfx-docs/drm/sound/soc/index.html">ALSA SoC Layer in Kernel Document</a>.</p>
<p>For example with iMX8MQ and wm8960 Codec.</p>
<p><code>wm8960.c</code> is <em>ASoC Codec Class driver</em>:</p>
<ul>
<li>
<p>register a soc dai driver by calling: <code>snd_soc_register_codec</code>. This DAI driver provides two streams: playback &amp; capture. It also provides DAI operation such as mute, free...</p>
</li>
<li>
<p>define mixers and audio paths by calling SOC_* macro.</p>
</li>
</ul>
<p><code>imx-wm8960.c</code> is <em>ASoC Platform Driver</em>.</p>
<h2 id="alsa-application">ALSA Application</h2>
<h3 id="arecord-aplay">arecord &amp; aplay</h3>
<blockquote>
<p>arecord -t raw -f S16_LE -c 1 output.raw</p>
</blockquote>
<p><code>output.raw</code> can be played by using <code>aplay</code></p>
<blockquote>
<p>aplay -f S16_LE output.raw</p>
</blockquote>
<p>or extracted by a simple C program.</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt;

int main()
{
    int16_t buf;
    int fd = open(&quot;./input&quot;, O_RDWR);
    if (fd &lt; 0) {
        printf(&quot;open file fail\n&quot;);
        return 1;
    }
    while (read(fd, &amp;buf, 2) &gt; 0)
        printf(&quot;%d\n&quot;, buf);
    close(fd);
    return 0;
}
</code></pre>
<p>Raw data </p>
<p><img alt="raw-data" src="../imgs/raw-audio-extract.png" /></p>
<h2 id="dapm-dynamic-audio-power-management">DAPM - Dynamic Audio Power Management</h2>
<p>Modern sound cards consist of many independent discrete components and each component has functional units that can be powered independently.</p>
<p><img alt="view-of-sound-card" src="../imgs/dapm-view-of-modern-sound-card.png" /></p>
<p><em>Figure. Anatomy of a modern sound card (Lars-Peter Clausen – Analog Devices)</em></p>
<h3 id="what-is-dapm">What is DAPM?</h3>
<p>DAPM is model data flow and power dependencies in a directed graph. Each <strong>node</strong> in graph represents a functional unit (called <strong>widget</strong>). <strong>Route</strong> or <strong>Path</strong> represent connections between functional units.</p>
<p><img alt="dapm-simple-path" src="../imgs/dapm-simple-graph.png" /></p>
<p>Eache widget (node) has a type and this type defines how the widget behaves in the graph. E.g. Speaker, Microphone, Amplifier, DAC, ADC, internal supply, external supply, headphone output, line-in input, line-out output, audio interface, audio interface link, mixer, mux, input pin, output pin ...</p>
<h3 id="how-dapm-works">How DAPM works?</h3>
<p>DAPM operation has two phases: </p>
<ul>
<li>Phase 1: Determine target power state</li>
<li>Phase 2: Power sequencing</li>
</ul>
<p>In phase 1, finding out the power state DAPM differentiates between three different categories of widgets: Enpoint widgets, Pass-through widgets, Supply widgets.</p>
<p><img alt="enpoint-widgets" src="../imgs/dapm-example-endpoint-widget.png" /></p>
<p>Power state of eache widget in graph is determined.</p>
<p><img alt="power-state" src="../imgs/dapm-power-state-determination.png" /></p>
<p>After Phase 1, target power state is determined. Widgets in graph is powered.</p>
<ul>
<li>Power-down all newly disabled widgets</li>
<li>Perform routing changes (if any)</li>
<li>Power-up all newly enabled widgets</li>
</ul>
<h3 id="case-study-wm8960">Case Study - WM8960</h3>
<p>Macro for defining widgets can be found at <code>/include/sound/soc-dapm.h</code>.</p>
<p>DAPM widgets in <code>wm8960.c</code> fall into a number of types:</p>
<ul>
<li>
<p>Stream Domain Widgets: ADCs (analog to digital converters), DACs (digital to analog converters). </p>
<p><code>SND_SOC_DAPM_ADC("Left ADC", "Capture", WM8960_POWER1, 3, 0),
SND_SOC_DAPM_ADC("Right ADC", "Capture", WM8960_POWER1, 2, 0),
SND_SOC_DAPM_DAC("Left DAC", "Playback", WM8960_POWER2, 8, 0),
SND_SOC_DAPM_DAC("Right DAC", "Playback", WM8960_POWER2, 7, 0),</code></p>
</li>
<li>
<p>Path Domain Widgets: Path domain widgets have a ability to control or affect the audio signal or audio paths within the audio subsystem</p>
<p><code>SOC_DAPM_SINGLE("Left Switch", WM8960_MONOMIX1, 7, 1, 0),
SOC_DAPM_SINGLE("Right Switch", WM8960_MONOMIX2, 7, 1, 0),</code></p>
</li>
</ul>
<p>Machine Widgets appears in <code>imx-wm8960.c</code>. A machine widget is assigned to each machine audio component (non codec or DSP) that can be independently powered. e.g Microphone Bias, Jack Connectors. In iMX8-MQ, machine widget and codec widget interconnections are defined in device tree:</p>
<pre><code>        audio-routing =
            &quot;Headphone Jack&quot;, &quot;HP_L&quot;,
            &quot;Headphone Jack&quot;, &quot;HP_R&quot;,
            &quot;Ext Spk&quot;, &quot;SPK_LP&quot;,
            &quot;Ext Spk&quot;, &quot;SPK_LN&quot;,
            &quot;LINPUT1&quot;, &quot;Main MIC&quot;,
            &quot;LINPUT2&quot;, &quot;Main MIC&quot;,
            &quot;RINPUT1&quot;, &quot;Mic Jack&quot;,
            &quot;Mic Jack&quot;, &quot;MICB&quot;,
            &quot;Main MIC&quot;, &quot;MICB&quot;,
            &quot;Playback&quot;, &quot;CPU-Playback&quot;,
            &quot;CPU-Capture&quot;, &quot;Capture&quot;;
</code></pre>
<p>Headphone Jack, Ext Spk, Main MIC, Mic Jack are machine widgets.</p>
<h2 id="physical-interface-definitions">Physical interface definitions</h2>
<h3 id="i2s-inter-ic-sound">I2S - Inter IC Sound</h3>
<p><strong>What is I2S? and What is I2S used for?</strong></p>
<p>I2S - Inter IC Sound is an electrical serial bus interface standard used for connecting digital audio devices together. This standard was introduced in 1986 by <strong>Philips Semiconductor</strong> (now <strong>NXP Semiconductors</strong>) and was last revised on June 5, 1996.</p>
<p><img alt="i2s-bus-in-system" src="../imgs/i2s-bus-in-a-system.png" /></p>
<p><strong>What is I2S made from?</strong></p>
<p><img alt="i2s-bus-spec" src="../imgs/i2s-bus-spec.png" /></p>
<p><em>Figure. I2S Bus Timing from <a href="https://www.sparkfun.com/datasheets/BreakoutBoards/I2SBUS.pdf">I2S standard</a> by Philips Seminconductors</em></p>
<p>The bus consists of at least three lines:</p>
<ul>
<li>Bit clock line: Officially "continuous serial clock (SCK)".[1] Typically written "bit clock (BCLK)".[2]</li>
<li>Word clock line: Officially "word select (WS)".[1] Typically called "left-right clock (LRCLK)"[2] or "frame sync (FS)".<ul>
<li>0 = Left channel</li>
<li>1 = Right channel</li>
</ul>
</li>
<li>At least one multiplexed data line<br />
        Officially "serial data (SD)",[1] but can be called SDATA, SDIN, SDOUT, DACDAT, ADCDAT, etc.[2]</li>
</ul>
<p><strong>What kind of data is transfered in I2S?</strong></p>
<p>Digital Audio Data e.g. <a href="https://en.wikipedia.org/wiki/Pulse-code_modulation">PCM</a></p>
<h3 id="sai-synchronous-audio-interface">SAI - Synchronous Audio Interface</h3>
<p><strong>Synchronous Audio Interface</strong> or <strong>Serial Audio Interface</strong>? It is quite hard to find definition for SAI in Internet. So, it will be defined by using an example from NPX IMX SoC.</p>
<p>In IMX8M, NXP integrates an audio module called SAI/I2S. This module which is platform device (has its own address in CPU memory map) will receive audio data from external CODEC and transfer these data to CPU. It supports I2S bus standard.</p>
<p><img alt="imx-sai" src="../imgs/sai-imx.png" /></p>
<h3 id="dai-digital-audio-interfaces">DAI - Digital Audio Interfaces</h3>
<p>ASoC currently supports the three main <strong>Digital Audio Interfaces (DAI)</strong> found on SoC controllers and portable audio CODECs today, namely AC97, I2S and PCM (PCM means a kind of bus, not a type of digital audio data).</p>
<h2 id="references">References</h2>
<p>[1] DAPM - Analog Device - Lars-Petter Clausen.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../jesd/jesd/" class="md-footer__link md-footer__link--prev" aria-label="Previous: JESD" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              JESD
            </div>
          </div>
        </a>
      
      
        
        <a href="../../pcie/pcie/" class="md-footer__link md-footer__link--next" aria-label="Next: PCIe" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              PCIe
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Vu Tang.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.2b46852b.min.js"></script>
      
    
  </body>
</html>