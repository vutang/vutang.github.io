



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://www.vutang.github.io/lnx_es/yocto/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0">
    
    
      
        <title>Yocto - Vu Tang's Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.8c900955.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#terms-and-definitions-in-yocto" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.vutang.github.io/" title="Vu Tang's Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Vu Tang's Docs
              </span>
              <span class="md-header-nav__topic">
                Yocto
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.vutang.github.io/" title="Vu Tang's Docs" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Vu Tang's Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      General Technote
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        General Technote
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../technote/mkdocs/mkdocs-notes/" title="Mkdocs Tool" class="md-nav__link">
      Mkdocs Tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../technote/markdown/markdown/" title="Markdown Language" class="md-nav__link">
      Markdown Language
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../technote/shellscript/shellscript/" title="Shell Script" class="md-nav__link">
      Shell Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../technote/python/python/" title="Python" class="md-nav__link">
      Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Book & Materials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Book & Materials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/c_books/" title="C Programing" class="md-nav__link">
      C Programing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/linux/" title="Linux Programing" class="md-nav__link">
      Linux Programing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/device_driver/" title="Linux Device Driver" class="md-nav__link">
      Linux Device Driver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/linux_kernel/" title="Linux Kernel" class="md-nav__link">
      Linux Kernel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/es_linux/" title="Linux Embedded" class="md-nav__link">
      Linux Embedded
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/dsa/dsa_toc/" title="Data Structure & Algorithms" class="md-nav__link">
      Data Structure & Algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../books/others/" title="Others" class="md-nav__link">
      Others
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Programming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Programming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/C/cprogramming/" title="C" class="md-nav__link">
      C
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/dsa/dsa/" title="DSA" class="md-nav__link">
      DSA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/sql/mysql/" title="SQL" class="md-nav__link">
      SQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../programming/lnx/lpi/" title="Linux Programming Interfaces" class="md-nav__link">
      Linux Programming Interfaces
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Linux General
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Linux General
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx/linux/" title="Unsorted" class="md-nav__link">
      Unsorted
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      Linux ES Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Linux ES Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../es/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hw_platform/" title="HW Platforms" class="md-nav__link">
      HW Platforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cmn_tool/" title="Common Tools" class="md-nav__link">
      Common Tools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ptlnx/" title="Xilinx Petalinux" class="md-nav__link">
      Xilinx Petalinux
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Yocto
      </label>
    
    <a href="./" title="Yocto" class="md-nav__link md-nav__link--active">
      Yocto
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#terms-and-definitions-in-yocto" title="Terms and definitions in Yocto" class="md-nav__link">
    Terms and definitions in Yocto
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bitbake" title="Bitbake" class="md-nav__link">
    Bitbake
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concept" title="Concept" class="md-nav__link">
    Concept
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-flow" title="Working flow" class="md-nav__link">
    Working flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recipe-syntax" title="Recipe syntax" class="md-nav__link">
    Recipe syntax
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terms-and-definitions-in-bitbake" title="Terms and definitions in Bitbake" class="md-nav__link">
    Terms and definitions in Bitbake
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bitbake-variables" title="Bitbake variables" class="md-nav__link">
    Bitbake variables
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tips/tips/" title="Tips" class="md-nav__link">
      Tips
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Linux Device Driver
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Linux Device Driver
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/kernel_module/" title="Kernel Module" class="md-nav__link">
      Kernel Module
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/platform_dev/platform_device/" title="Platform Device" class="md-nav__link">
      Platform Device
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/spi_dev/spi_dev/" title="SPI Device" class="md-nav__link">
      SPI Device
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/spi_dev/spi_advance/" title="SPI Device Advance" class="md-nav__link">
      SPI Device Advance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/gpio/gpio/" title="GPIO" class="md-nav__link">
      GPIO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_ldd/uart/uart/" title="UART" class="md-nav__link">
      UART
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Linux Kernel Development
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Linux Kernel Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_kernel/kernel_data_structure/" title="Kernel Data Structure" class="md-nav__link">
      Kernel Data Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../lnx_kernel/kernel_user_space/" title="Kernel Space, User Space Interfaces" class="md-nav__link">
      Kernel Space, User Space Interfaces
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      FPGA
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        FPGA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../fpga/timing_analysis/timing_analysis/" title="Static Timing Analysis" class="md-nav__link">
      Static Timing Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fpga/x_ipcore/xipcore/" title="Xilinx IPCore" class="md-nav__link">
      Xilinx IPCore
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Projects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/zynq/zynq/" title="Zynq" class="md-nav__link">
      Zynq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../projects/pi3b/" title="Raspberrypi 3B" class="md-nav__link">
      Raspberrypi 3B
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../bookmarks/bookmarks/" title="Bookmarks" class="md-nav__link">
      Bookmarks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../whatnext/" title="What's next" class="md-nav__link">
      What's next
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../about/about/" title="About me" class="md-nav__link">
      About me
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#terms-and-definitions-in-yocto" title="Terms and definitions in Yocto" class="md-nav__link">
    Terms and definitions in Yocto
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bitbake" title="Bitbake" class="md-nav__link">
    Bitbake
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concept" title="Concept" class="md-nav__link">
    Concept
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-flow" title="Working flow" class="md-nav__link">
    Working flow
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recipe-syntax" title="Recipe syntax" class="md-nav__link">
    Recipe syntax
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terms-and-definitions-in-bitbake" title="Terms and definitions in Bitbake" class="md-nav__link">
    Terms and definitions in Bitbake
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bitbake-variables" title="Bitbake variables" class="md-nav__link">
    Bitbake variables
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Yocto</h1>
                
                <h2 id="terms-and-definitions-in-yocto">Terms and definitions in Yocto</h2>
<p>Các khái niệm này được mô tả tại <a href="https://www.yoctoproject.org/docs/latest/ref-manual/ref-manual.html">Yocto Reference Manual</a>.</p>
<p><strong>Build Directory</strong></p>
<p>Là khu vực Yocto sử dụng để build hệ thống. Trong trường hợp của Petalinux 2017.4, Build Dir là <project>/build. TOPDIR được sử dụng để lưu trữ đường dẫn đến Build Dir.</p>
<p><strong>Package</strong></p>
<p>Đối tượng tác động đến trong Yocto là Package. Trong đó một application, library, bootloader hay kernel đều được định nghĩa và coi là Package trong phạm vi của Yocto project. Người dùng cần cung cấp các thông tin để Yocto có thể "bake" được từng package, thông tin này được lưu trữ dưới dạng các <strong>Recipes file</strong> (with .bb extention).</p>
<p>Một package được đặt tên theo dạng: ${PN}-${EXTENDPE}${PV}-${PR}. Trong đó:</p>
<ul>
<li>PN: package name, đồng thời là recipe name của package đó.</li>
<li>PV: version of recipe</li>
<li>PR: revision of recipe</li>
</ul>
<p><em>Các khái niệm này rất hữu ích trong quá trình đọc các recipe files</em></p>
<h2 id="bitbake">Bitbake</h2>
<h3 id="references">References</h3>
<ul>
<li>
<p>[1] <a href="https://www.yoctoproject.org/docs/1.6/bitbake-user-manual/bitbake-user-manual.html">Bitbake User Manual</a> - yoctoproject.org</p>
</li>
<li>
<p>[2] <a href="https://www.yoctoproject.org/docs/2.5/overview-manual/overview-manual.html">Yocto Project Overview and Concepts Mannual</a> - yoctoproject.org</p>
</li>
</ul>
<h3 id="concept">Concept</h3>
<p>Yocto xem các packages (khái niệm packages trong Yocto rất rộng, nó có thể là SDK, Linux Kernel, bootloader, gói ứng dụng, thư viên, ...) như là các món ăn, trong đó <code>Bitbake</code> là đầu bếp.</p>
<p><em>*Bitbake được viết từ Python</em></p>
<p>Đầu bếp <code>Bitbake</code> nấu các món ăn dưới các công thức được viết sẵn bởi người yêu cầu gọi là <code>recipe</code> (/ˈresəpi/). <code>recipe</code> bản chất là một file có phần mở rộng là <code>.bb</code>. Yocto có một bộ cú pháp dành riêng cho viết <code>recipe</code>.</p>
<h3 id="working-flow">Working flow</h3>
<p>Refer in <a href="https://www.yoctoproject.org/docs/2.5/overview-manual/overview-manual.html#bitbake-dev-environment">4.3.5</a> tại [2].</p>
<p>Trong Yocto, để thuận tiện cho việc "nấu ăn" được chuyên nghiệp, quá trình "bake" của <code>Bitbake</code> được chia ra các quá trình nhỏ. Tất cả các món ăn đều phải được kiểm tra và thực hiện qua các bước này. Các bước này được định nghĩa tại một class: <code>base.bbclass</code>. Và tất nhiên, người dùng có thể không sử dụng công thức nấu mặc định mà thay đổi các bước này bằng các định nghĩa trong <code>recipe</code> của họ. Các bước đó là</p>
<p><strong>Source Fetching, Patching</strong></p>
<p><code>do\_fetch -&gt; do_unpack -&gt; do_patch</code></p>
<p><strong>Configuration, Compilation, and Staging</strong></p>
<p><code>do_configure -&gt; do_compile -&gt; do_install</code></p>
<p><em>do_configure</em> tiến hành các tác vụ cấu hình trước khi build một gói phần mềm. Có thể hình dung quá trình này giống như chạy ./configure trước khi make một chương trình.</p>
<p><em>do_compile</em> đa phần sẽ tiến hành gọi <code>make</code> đến <code>Makefile</code> của mã nguồn gói phần mềm. Kết quả của quá trình được lưu trữ ngay cùng mới mã nguồn vừa được build. Gọi là directory S/B.</p>
<p><em>do_install</em></p>
<p>Copy binarry file from S/B (kết quả của task do_compile) dir to D (image - destination dir). Binary lưu trữ tại thư mục D sẽ được sử dụng cho quá các quá trình <code>do_package</code>, <code>do_packagedata</code> và <code>do_populate_sysroot</code></p>
<p><strong>Package Splitting</strong></p>
<p><code>do_package, do_packagedata</code></p>
<p>Một bộ mã nguồn có thể compile một lúc ra rất nhiều ứng dụng, các ứng dụng này có thể được nhóm lại với nhau thành các packages. Ví dụ với mã nguồn libiio có thể build ra được các gói như: libiio, libiio-test (chứa iio_infor), libiio-iiod (chứa IIO Deamon)... Tác dụng của <code>do_package</code> là phân tác các binary (cũng như dữ liệu đi kèm nếu có) thành các gói phần mềm khác nhau.</p>
<p><code>do_populate_sysroot</code></p>
<p>Được định nghĩa trong <code>layers/core/meta/classes/staging.bbclass</code> sử dụng để staging kết quả build tail build directory temporary đến <code>build/tmp/work/cortexa9hf-neon-xilinx-linux-gnueabi/libiio/0.15+gitAUTOINC+6ecff5d46e-r0/sysroot-destdir/</code>.</p>
<p>Quá trình <code>-c do_populate_sysroot</code> sẽ tiến hành thêm <code>do_qa_staging</code> và <code>sstate_task_postfunc</code> (được định nghĩa trong <code>sstate.bbclass</code>).</p>
<p>Hàm <code>sstate_task_postfunc</code> sẽ tiến hành stagging file từ <code>sysroot-destdir</code> đến <code>build/tmp/sysroots/plnx_arm</code>. Hiện tại vẫn chưa tìm hiểu được tác dụng của thư mục này cũng như tác dụng của <code>do_populate_sysroot</code>.</p>
<p><strong>RPM Package Generation</strong></p>
<p><code>do_package_write_rpm</code></p>
<p>Được định nghĩa trong <code>layers/core/meta/classes/package_rpm.bbclass</code> có nhiệm vu creates RPM packages (i.e. *.rpm files) and places them in the <code>${DEPLOY_DIR_RPM}</code> directory in the package feeds area. Trong Petalinux 2017.4 (một thực thể ứng dụng Yocto) thì <code>${DEPLOY_DIR_RPM}</code> được định nghĩa là <code>build/tmp/deploy/rpm</code>. Các gói phần mềm đã được đóng gói dưới định dạng RPM sẽ được đưa đến thư mục này. Ví dụ như các gói trong libiio: (liệt kê các gói tại đây).</p>
<p>Bản chất hàm <code>do_package_rpm</code> trong <code>package_rpm.bbclass</code> sẽ gọi đến công cụ <a href="https://linux.die.net/man/8/rpmbuild">rpmbuild</a> - linux.die.net (một công cụ được sử dụng để build RPM package). Quá trình chạy <code>rpmbuild</code> cần đến SPEC File. Tham khảo thêm về SPEC file <a href="https://rpm-packaging-guide.github.io/">tại đây</a>. Quá trình thực hiện rpmbuild được thực hiện tại khu vực build của từng package. Ví dụ trong trường hợp package là libiio:</p>
<p><code>build/tmp/work/cortexa9hf-neon-xilinx-linux-gnueabi/libiio/0.15+gitAUTOINC+6ecff5d46e-r0</code></p>
<p><em>For checking an un-installed RPM pkg, use <code>rpm -qip &lt;name&gt;.rpm</code>. Read more at: <a href="https://www.tecmint.com/20-practical-examples-of-rpm-commands-in-linux/">https://www.tecmint.com/20-practical-examples-of-rpm-commands-in-linux/</a></em></p>
<p>Như vậy, từ các binary được build bởi các tác vụ <code>do_configure/do_compile/do_install</code>, <code>do_package_write_rpm</code> sẽ đóng gói thành các rpm package sẵn sàng cho cài đặt.</p>
<p><strong>Rootfs Generation</strong></p>
<p><code>do_rootfs</code></p>
<p>Tiến hành theo package <code>petalinux-user-image</code>.</p>
<p><code>do_rootfs</code> được định nghĩa tại <code>layers/core/meta/classes/image.bbclass</code> thực hiện tìm một danh sách các <strong>package (.rpm, .deb)</strong> (thông tin về các packages này được chứa trong biến môi trường <code>PACKAGE_INSTALL</code>) để tiến hành copy đến <code>IMAGE_ROOTFS</code>. Theo định nghĩa của Yocto, <code>IMAGE_ROOTFS</code> là "The location of the root filesystem while it is under construction". Trong một trường hợp thực tế, <code>IMAGE_ROOTFS</code> là:</p>
<p><code>build/tmp/work/plnx_arm-xilinx-linux-gnueabi/petalinux-user-image/1.0-r0/rootfs</code></p>
<ul>
<li>What is relation ship between <code>PACKAGE_INSTALL</code> and <code>IMAGE_INSTALL</code>?</li>
<li>how Yocto creates these .rpm, .deb packages?</li>
</ul>
<p><code>IMAGE_ROOTFS</code> là nơi chứa rootfs, kết quả build của hệ thống. Từ rootfs có thể được đóng gói thành các định dạng khác nhau như: cpio, ext4, ext3, jffs2, ...</p>
<p><code>do_image_ext3/4</code></p>
<p>Đóng gói rootfs trong <code>IMAGE_ROOTFS</code> thành các định dạng filesystem ext3/ext4.</p>
<p>Tiến hành đóng gói rootfs dưới định dạng ext3. Bản chất của hàm này sẽ gọi đến <code>oe_mkext234fs</code> được định nghĩa trong <code>layers/core/meta/classes/image_types.bbclass</code>.</p>
<p>Hàm <code>oe_mkext234fs</code> gọi đến <code>mkfs.ext3/4</code> (là một bộ công cụ đóng gói một bộ tập tin dưới dạng file có thể được sử dụng cho các định dạng ext3/ext4) để tiến hành đóng gói rootfs.</p>
<p><strong>SDK Generation</strong></p>
<h3 id="recipe-syntax">Recipe syntax</h3>
<p><strong><a href="https://www.yoctoproject.org/docs/1.6/bitbake-user-manual/bitbake-user-manual.html#sharing-functionality">Sharing Functionality</a></strong></p>
<p>BitBake allows for metadata sharing through include files (.inc) and class files (.bbclass).</p>
<p><em>inherit</em>: là directive. Ví dụ <code>inherit autotools</code> được sử dụng để kế thừa toàn bộ hàm của class autotools.bbclass. Người dùng có thể "override" các hàm của class được kế thừa bằng cách phát triển các hàm hoặc biến đó sau directive <code>inherit</code>.</p>
<h2 id="terms-and-definitions-in-bitbake">Terms and definitions in Bitbake</h2>
<p><strong><a href="https://www.yoctoproject.org/docs/2.7/bitbake-user-manual/bitbake-user-manual.html#idm45270752297552">File Download Support</a></strong></p>
<p>Bitbake cung cấp cơ chế download/unpack/patching source code. Fetcher (Downloader) tiến hành download source code từ local/remote repository.</p>
<p>Quá trình unpack thực hiện giải nén source code ngay sau quá trình download source code. Unpacker hỗ trợ decompress/extract các file có phần mở rộng như sau: ".Z", ".z", ".gz", ".xz", ".zip", ".jar", ".ipk", ".rpm". ".srpm", ".deb" and ".bz2".</p>
<h2 id="bitbake-variables">Bitbake variables</h2>
<p><strong><a href="https://www.yoctoproject.org/docs/latest/ref-manual/ref-manual.html#var-SRC_URI">${SRC_URI}</a></strong></p>
<p>The list of source files - local or remote.</p>
<p>Được sử dụng trong recipe file để thông báo cho Yocto source code nào của package sẽ được sử dụng để build. Yocto Fetcher (Downloader) tiến hành download và bổ sung các bản vá vào source code trước khi tiến hành các bước tiếp theo.</p>
<p><strong>${IMAGE_INSTALL}</strong><br />
Used by recipes to specify the packages to install into an image through the image class</p>
<p><strong>${PACKAGES}</strong><br />
The list of packages the recipe creates.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../ptlnx/" title="Xilinx Petalinux" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Xilinx Petalinux
              </span>
            </div>
          </a>
        
        
          <a href="../tips/tips/" title="Tips" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Tips
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Vu Tang.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b41f3d20.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>