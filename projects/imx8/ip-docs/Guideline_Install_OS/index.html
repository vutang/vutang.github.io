
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://www.vutang.github.io/projects/imx8/ip-docs/Guideline_Install_OS/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.2">
    
    
      
        <title>i.MX Linux User's Guide - Vu Tang's Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.1118c9be.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ba0d045b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#imx-linux-users-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Vu Tang&#39;s Docs" class="md-header__button md-logo" aria-label="Vu Tang's Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vu Tang's Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              i.MX Linux User's Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Vu Tang&#39;s Docs" class="md-nav__button md-logo" aria-label="Vu Tang's Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Vu Tang's Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        General Technote
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="General Technote" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          General Technote
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../technote/mkdocs/mkdocs-notes/" class="md-nav__link">
        Mkdocs Tool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../technote/markdown/markdown/" class="md-nav__link">
        Markdown Language
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../technote/shellscript/shellscript/" class="md-nav__link">
        Shell Script
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../technote/python/python/" class="md-nav__link">
        Python
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../technote/virutal_machine/virtual_box.md" class="md-nav__link">
        Virtual Machine
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Book & Materials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Book & Materials" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Book & Materials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/c_books/" class="md-nav__link">
        C Programing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/linux/" class="md-nav__link">
        Linux Programing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/device_driver/" class="md-nav__link">
        Linux Device Driver
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/linux_kernel/" class="md-nav__link">
        Linux Kernel
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/es_linux/" class="md-nav__link">
        Linux Embedded
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/dsa/dsa_toc/" class="md-nav__link">
        Data Structure & Algorithms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../books/others/" class="md-nav__link">
        Others
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Programming
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Programming" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Programming
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/C/cprogramming/" class="md-nav__link">
        C
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/dsa/dsa/" class="md-nav__link">
        DSA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/sql/mysql/" class="md-nav__link">
        SQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/lnx/lpi/" class="md-nav__link">
        Linux Programming Interfaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/dsg_patterns/" class="md-nav__link">
        Design Patterns
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/multi-threaded-programming/" class="md-nav__link">
        Multi-threads
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../programming/perf/perf/" class="md-nav__link">
        Perf
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Linux General
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux General" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Linux General
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx/linux/" class="md-nav__link">
        Unsorted
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx/cmds/" class="md-nav__link">
        Commands
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Linux ES Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux ES Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Linux ES Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/es/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/hw_platform/" class="md-nav__link">
        HW Platforms
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/cmn_tool/" class="md-nav__link">
        Common Tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/version_control/git/" class="md-nav__link">
        Git
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/ptlnx/" class="md-nav__link">
        Xilinx Petalinux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/yocto/" class="md-nav__link">
        Yocto
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/eeprom/eeprom/" class="md-nav__link">
        EEPROM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_es/tips/tips/" class="md-nav__link">
        Tips
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        Linux Device Driver
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux Device Driver" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Linux Device Driver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/kernel_module/" class="md-nav__link">
        Kernel Module
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/platform_dev/platform_device/" class="md-nav__link">
        Platform Device
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/spi_dev/spi_dev/" class="md-nav__link">
        SPI Device
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/spi_dev/spi_advance/" class="md-nav__link">
        SPI Device Advance
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/gpio/gpio/" class="md-nav__link">
        GPIO
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/uart/uart/" class="md-nav__link">
        UART
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/jesd/jesd/" class="md-nav__link">
        JESD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/audio/linux_audio/" class="md-nav__link">
        Audio
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_ldd/pcie/pcie/" class="md-nav__link">
        PCIe
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        Linux Kernel Development
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux Kernel Development" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Linux Kernel Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_kernel/kernel_data_structure/" class="md-nav__link">
        Kernel Data Structure
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../lnx_kernel/kernel_user_space/" class="md-nav__link">
        Kernel Space, User Space Interfaces
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      <label class="md-nav__link" for="__nav_9">
        FPGA
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FPGA" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          FPGA
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../fpga/timing_analysis/timing_analysis/" class="md-nav__link">
        Static Timing Analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../../fpga/x_ipcore/xipcore/" class="md-nav__link">
        Xilinx IPCore
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      <label class="md-nav__link" for="__nav_10">
        Projects
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Projects" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Projects
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../zynq/zynq/" class="md-nav__link">
        Zynq
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../imx8/" class="md-nav__link">
        IMX8
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../../pi3b/" class="md-nav__link">
        Raspberrypi 3B
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../bookmarks/bookmarks/" class="md-nav__link">
        Bookmarks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../whatnext/" class="md-nav__link">
        What's next
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/about/" class="md-nav__link">
        About me
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="imx-linux-users-guide">i.MX Linux User's Guide</h1>
<p><strong><em>Booting Linux OS.</em></strong></p>
<h1 id="1-software-overview">1. Software Overview</h1>
<p>Một boot Linux image trên i.MX 8M Quad hoặc i.MX 8M Mini gồm 4 thành phần:</p>
<ul>
<li>imx-boot (built bằng imx-mkimage), gồm SPL, U-Boot, Arm Trusted Firmware, DDR firmware và HDMI firmware.</li>
<li>Linux kernel images.</li>
<li>Device tree file (.dtb).</li>
<li>Root file system (rootfs).</li>
</ul>
<h1 id="2-universal-update-utility">2. Universal update utility</h1>
<p>UUU chạy trên Windows hoặc Linux OS, được dùng để tải images vào các devices khác nhau của i.MX board.</p>
<h1 id="3-preparing-an-sdmmc-card-to-boot">3. Preparing an SD/MMC card to boot</h1>
<p>Yocto Project build tạo ra SD card image và có thể dùng trực tiếp nó để tạo boot SD card. Do đó, có thể copy full SD card image hoặc copy từng thành phần.</p>
<h1 id="4-downloading-images">4. Downloading images</h1>
<p>Có thể download images vào device bằng U-Boot khi U-Boot đã được loaded vào boot device.</p>
<p>Dùng TFTP để tải images vào RAM rồi ghi vào SD card. Ví dụ:</p>
<ol>
<li>
<p>Reset boot environments về default:</p>
<pre><code>U-Boot &gt; env default -f -a
U-Boot &gt; saveenv
U-Boot &gt; reset
</code></pre>
</li>
<li>
<p>Cấu hình boot environments để tải được images:</p>
<pre><code>U-Boot &gt; setenv serverip &lt;TFTP server ip&gt;
U-Boot &gt; setenv bootfile &lt;kernel name zImage/Image&gt;
U-Boot &gt; setenv fdt_file &lt;dtb image&gt;
</code></pre>
<p>Có thể đặt facke MAC address:</p>
<pre><code>U-Boot &gt; setenv ethaddr 00:01:02:03:04:05
U-Boot &gt; save
</code></pre>
</li>
<li>
<p>Copy zImage/Image vào TFTP server, sau đó tải nó vào RAM:</p>
<pre><code>U-Boot &gt; dhcp
</code></pre>
</li>
<li>
<p>Kiểm tra thông tin MMC/SD card:</p>
<pre><code>U-Boot &gt; mmc dev
U-Boot &gt; mmcinfo
</code></pre>
</li>
<li>
<p>Xem usage của lệnh <em>mmc</em>. "blk#" bằng với "&lt;offset của read/write&gt;/&lt;block length of the card&gt;". "cnt" bằng "&lt;the size of read/write&gt;/&lt;block length of the card&gt;".</p>
<pre><code>U-Boot &gt; help mmc
Usage:
mmc read addr blk# cnt
mmc write addr blk# cnt
mmc erase blk# cnt
mmc rescan
mmc part - lists available partition on current mmc device
mmc dev [dev] [part] - show or set current mmc device [partition]
mmc list - lists available devices
</code></pre>
</li>
<li>
<p>Program kernel đã tải vào RAM (tại <em>loadaddr</em>) vào SD card. Ví dụ image có size 0x800000 từ ${loadaddr} vào offset 0x100000 của microSD card:</p>
<p>Tính toán thông số như sau:</p>
<pre><code>blk# = (microSD Offset)/(SD block length) = 0x100000/0x200 = 0x800
cnt = (image Size)/(SD block length) = 0x800000/0x200 = 0x4000
</code></pre>
<p>Lệnh trong U-Boot:</p>
<pre><code>U-Boot &gt; mmc dev 2 0
U-Boot &gt; tftpboot ${loadaddr} ${bootfile}
### Suppose the kernel zImage is less than 8M.
U-Boot &gt; mmc write ${loadaddr} 0x800 0x4000
</code></pre>
</li>
<li>
<p>Program dtb file:</p>
<pre><code>U-Boot &gt; tftpboot ${fdt_addr} ${fdt_file}
U-Boot &gt; mmc write ${fdt_addr} 0x5000 0x800
</code></pre>
</li>
<li>
<p>Với i.MX 8M Quad EVK board, dùng SD1 slot với mmcblk1 để boot.</p>
</li>
<li>
<p>Boot the board:</p>
<pre><code>U-Boot &gt;setenv bootcmd_mmc 'run bootargs_base mmcargs;mmc dev;mmc read ${loadaddr} 0x800 0x4000;mmc read ${fdt_addr} 0x5000 0x800;bootz ${loadaddr} - $ {fdt_addr}'
U-Boot &gt; setenv bootcmd 'run bootcmd_mmc'
U-Boot &gt; saveenv
</code></pre>
</li>
</ol>
<h2 id="41-using-emmc">4.1. Using eMMC</h2>
<p>Có một eMMC chip trên kit i.MX 8M Quad và i.MX 8M Mini. Truy cập chip này thông qua SDHC1.</p>
<p>Table 22. Switch setup for booting from eMMC on i.MX 8M Quad EVK</p>
<table>
<thead>
<tr>
<th>Switch</th>
<th>D1</th>
<th>D2</th>
<th>D3</th>
<th>D4</th>
</tr>
</thead>
<tbody>
<tr>
<td>SW801</td>
<td>OFF</td>
<td>OFF</td>
<td>ON</td>
<td>OFF</td>
</tr>
</tbody>
</table>
<p>Custom U-Boot đã hỗ trợ các lệnh install U-Boot, kernel, device-tree, rootfs trong môi trường U-Boot. Việc cần làm là partition eMMC cho phù hợp.
Có thể partiton trong môi trường U-Boot. Ở đây trình bày partition trong môi trường Linux và install OS trong cả 2 môi trường.</p>
<ol>
<li>
<p>Partitioning eMMC</p>
<p>1.1. Boot mạch bằng SD card.</p>
<p>1.2. Thực hiện partition:</p>
<pre><code>$ for dev in /dev/mmcblk0p*; do umount $dev; done
$ fdisk /dev/mmcblk0 # Lưu ý: có 2 phiên bản fdisk có cách sử dụng tương đối khác nhau
</code></pre>
<p>Ví dụ:</p>
<pre><code>Welcome to fdisk (util-linux 2.32.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.
</code></pre>
<p><strong>Command (m for help):</strong> m</p>
<pre><code>Help:

  GPT
   M   enter protective/hybrid MBR

  Generic
   d   delete a partition
   F   list free unpartitioned space
   l   list known partition types
   n   add a new partition
   p   print the partition table
   t   change a partition type
   v   verify the partition table
   i   print information about a partition

  Misc
   m   print this menu
   x   extra functionality (experts only)

  Script
   I   load disk layout from sfdisk script file
   O   dump disk layout to sfdisk script file

  Save &amp; Exit
   w   write table to disk and exit
   q   quit without saving changes

  Create a new label
   g   create a new empty GPT partition table
   G   create a new empty SGI (IRIX) partition table
   o   create a new empty DOS partition table
   s   create a new empty Sun partition table
</code></pre>
<p><strong>Command (m for help):</strong> p</p>
<pre><code>Disk /dev/mmcblk0: 14.7 GiB, 15758000128 bytes, 30777344 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: 7A880C17-75F2-4CD1-AF51-E8B99D98B90E

Device            Start      End  Sectors  Size Type
/dev/mmcblk0p1    20480   282623   262144  128M Linux filesystem
/dev/mmcblk0p2   282624 12582911 12300288  5.9G Linux filesystem
/dev/mmcblk0p3 12582912 12845055   262144  128M Linux filesystem
/dev/mmcblk0p4 12845056 16777215  3932160  1.9G Linux filesystem
</code></pre>
<p><strong>Command (m for help):</strong> d</p>
<pre><code>Partition number (1-4, default 4):

Partition 4 has been deleted.
</code></pre>
<p><strong>Command (m for help):</strong> d</p>
<pre><code>Partition number (1-3, default 3):

Partition 3 has been deleted.
</code></pre>
<p><strong>Command (m for help):</strong> d</p>
<pre><code>Partition number (1,2, default 2):

Partition 2 has been deleted.
</code></pre>
<p><strong>Command (m for help):</strong> d</p>
<pre><code>Selected partition 1
Partition 1 has been deleted.
</code></pre>
<p><strong>Command (m for help):</strong> p</p>
<pre><code>Disk /dev/mmcblk0: 14.7 GiB, 15758000128 bytes, 30777344 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: gpt
Disk identifier: 7A880C17-75F2-4CD1-AF51-E8B99D98B90E
</code></pre>
<p><strong>Command (m for help):</strong> n</p>
<pre><code>Partition number (1-128, default 1): 1
First sector (34-30777310, default 2048): 20480
Last sector, +sectors or +size{K,M,G,T,P} (20480-30777310, default 30777310): +128M

Created a new partition 1 of type 'Linux filesystem' and of size 128 MiB.
Partition #1 contains a vfat signature.

Do you want to remove the signature? [Y]es/[N]o: Y

The signature will be removed by a write command.
</code></pre>
<p><strong>Command (m for help):</strong> n</p>
<pre><code>Partition number (2-128, default 2): 
First sector (34-30777310, default 282624): 
Last sector, +sectors or +size{K,M,G,T,P} (282624-30777310, default 30777310): +6006M

Created a new partition 2 of type 'Linux filesystem' and of size 5.9 GiB.
Partition #2 contains a ext4 signature.

Do you want to remove the signature? [Y]es/[N]o: Y

The signature will be removed by a write command.
</code></pre>
<p><strong>Command (m for help):</strong> n</p>
<pre><code>Partition number (3-128, default 3): 
First sector (34-30777310, default 12582912): 
Last sector, +sectors or +size{K,M,G,T,P} (12582912-30777310, default 30777310): +128M

Created a new partition 3 of type 'Linux filesystem' and of size 128 MiB.
Partition #3 contains a vfat signature.

Do you want to remove the signature? [Y]es/[N]o: Y

The signature will be removed by a write command.
</code></pre>
<p><strong>Command (m for help):</strong> n</p>
<pre><code>Partition number (4-128, default 4): 
First sector (34-30777310, default 12845056): 
Last sector, +sectors or +size{K,M,G,T,P} (12845056-30777310, default 30777310):

Created a new partition 4 of type 'Linux filesystem' and of size 8.6 GiB.
Partition #4 contains a ext4 signature.

Do you want to remove the signature? [Y]es/[N]o: Y

The signature will be removed by a write command.
</code></pre>
<p><strong>Command (m for help):</strong> w</p>
<pre><code>The partition table has been altered.
Syncing disks.
</code></pre>
</li>
<li>
<p>Install OS to eMMC </p>
<p>2.1. Clean boot environments lưu trong eMMC</p>
<pre><code>U-Boot &gt; env default -f -a
U-Boot &gt; save
U-Boot &gt; reset
</code></pre>
<p>2.2. Program U-Boot</p>
<p>File nằm ở <em>tmp/deploy/images/imx8mqevk/imx-boot-imx8mqevk-sd.bin-flash_evk</em> khi build bằng Yocto hoặc trong <em>package/flash.bin</em> khi build standalone. Copy và đổi tên thành <em>/tftpboot/flash.bin</em>.</p>
<p>Trên linux:</p>
<pre><code>$ echo 0 &gt; /sys/block/mmcblk0boot0/force_ro
$ dd if=u-flash.bin of=/dev/mmcblk0boot0 bs=1k seek=33 conv=fsync
</code></pre>
<p>Trong U-Boot. Xác định size in block của U-Boot: lấy size (byte) của flash.bin / 512. Đổi kết quả ra hex rồi + 1. Ví dụ được 0xb0d.</p>
<pre><code>U-Boot &gt; setenv uboot_size_blk 0xb0d
U-Boot &gt; run installuboot
</code></pre>
<p>2.3. Program kernel, device-tree</p>
<p>Kernel nằm ở <em>tmp/deploy/images/imx8mqevk/Image</em> khi build Yocto hoặc <em>arch/arm64/boot/Image</em> khi build standalone. Copy vào <em>/tftpboot</em>.</p>
<p>Device-tree nằm ở: <em>tmp/deploy/images/imx8mqevk/fsl-imx8mq-evk.dtb</em> khi build Yocto hoặc <em>arch/arm64/boot/dts/freescale/fsl-imx8mq-evk.dtb</em> khi biuld standalone. Copy và đổi tên thành <em>/tftpboot/devicetree.dtb</em>.</p>
<p>Trên linux:</p>
<pre><code>$ mkdir /mnt/p1
$ mount -t vfat /dev/mmcblk0p1 /mnt/p1
$ cp /run/{fsl-imx8mq-evk.dtb,Image} /mnt/p1
$ sync
$ umount /mnt/p1
</code></pre>
<p>Trong U-Boot: </p>
<pre><code>U-Boot &gt; run installkernel
U-Boot &gt; run installfdt
</code></pre>
<p>2.4. Program rootfs</p>
<p>File nằm ở <em>tmp/deploy/images/imx8mqevk/core-image-minimal-imx8mqevk.ext4</em>. Copy và đổi tên thành <em>/tftpboot/rootfs.ext4</em></p>
<p>Trên Linux: </p>
<pre><code>$ mkdir /mnt/p2
$ mount -t ext4 /dev/mmcblk0p2 /mnt/p2
$ cp rootfs.ext4 /mnt/p2
$ sync
$ umount /mnt/p2
</code></pre>
<p>Trong U-Boot: xác định size in block của rootfs.ext4. Ví dụ 0x20000</p>
<pre><code>U-Boot &gt; setenv root_size_blk 0x20000
U-Boot &gt; run installroot
</code></pre>
<p>2.5. Thiết lập bootargs</p>
<p>Với các loại display khác nhau, cần bootargs khác nhau. Xem i.MX Linux User Guide để biết chi tiết.</p>
<p>Trong custom U-Boot đã có sẵn lệnh boot nên sau khi cập nhật OS, mạch đã có thể boot được.</p>
<p>2.8. Install recovery OS</p>
<p>Tương tự như trên.</p>
</li>
</ol>
<h2 id="42-using-sd-card">4.2. Using SD card</h2>
<p>Với i.MX 8M Quad EVK, boot từ SD card đặt ở slot SD2</p>
<p>Table 9. Switch setup for booting from TF on i.MX 8M Quad EVK</p>
<table>
<thead>
<tr>
<th>Switch</th>
<th>D1</th>
<th>D2</th>
<th>D3</th>
<th>D4</th>
</tr>
</thead>
<tbody>
<tr>
<td>SW801</td>
<td>ON</td>
<td>ON</td>
<td>OFF</td>
<td>OFF</td>
</tr>
<tr>
<td>SW802</td>
<td>ON</td>
<td>OFF</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>SD card image cung cấp đủ để boot với U-Boot và kernel. Để flash SD card image, kết nối SD card với máy tính và chạy các lệnh sau:</p>
<pre><code>$ bunzip2 -dk -f &lt;image_name&gt;.sdcard.bz2 
$ sudo dd if=&lt;image name&gt;.sdcard of=/dev/&lt;sdcard&gt; bs=1M conv=fsync
</code></pre>
<p>Xem thêm tại phần  "Preparing an SD/MMC Card to Boot" trong the i.MX Linux® User's Guide (IMXLUG).
Ví dụ:</p>
<pre><code>$ bunzip2 -dk -f core-image-minimal-imx8mqevk.sdcard.bz2
$ sudo dd if=core-image-minimal-imx8mqevk.sdcard of=/dev/mmcblk0 bs=1M conv=fsync
</code></pre>
<p>Để cập nhật các thành phần OS (kernel, device-tree, rootfs) thì làm như sau:</p>
<p>Khi thực hiện các lệnh trên, SD card đã có các partition là mmcblk0p1 (cho kernel, DTB) và mmcblk0p2 (cho rootfs). Việc cần làm làm mount các parition này và copy image vào. Ví dụ cụ thể:</p>
<pre><code>* Với kernel, DTB:

$ mkdir /tmp/p1
$ sudo mkfs.vfat /dev/mmcblk0p1 (Thường phải umount partition này trước)
$ sudo mount -t vfat /dev/mmcblk0p1 /tmp/p1/
$ sudo cp &lt;build_dir&gt;/tmp/deploy/images/imx8mqevk/{Image,fsl-imx8mq-evk.dtb} /tmp/p1/
$ sudo umount /tmp/p1

* Với rootfs:

$ mkdir /tmp/p2
$ sudo mkfs.ext4 /dev/mmcblk0p2
$ sudo mount -t ext4 /dev/mmcblk0p2 /tmp/p2
$ tar -xjvf &lt;build_dir&gt;/tmp/deploy/images/imx8mqevk/core-image-minimal-imx8mqevk.tar.bz2 -C /tmp/p2/
$ sudo umount /tmp/p2
$ sync
</code></pre>
<h2 id="43-using-usb">4.3. Using USB</h2>
<p>Chỉ hỗ trợ boot từ phần kernel, không hỗ trợ U-Boot.
Để boot từ USB, cần làm như sau:</p>
<ul>
<li>Partition USB thành 2 phân vùng: fat32 chứa kernel, device-tree; ext4 chứa rootfs.</li>
<li>Copy kernel (Image), device-tree (devicetree.dtb) vào phân vùng fat32.</li>
<li>Copy rootfs (rootfs.ext4) vào phân vùng ext4.</li>
<li>Trong U-Boot:<pre><code>U-Boot &gt; usb start
U-Boot &gt; setenv usbroot /dev/sda2 rootwait rw
U-Boot &gt; setenv bootargs ${jh_clk} console=${console} root=${usbroot}
U-Boot &gt; fatload usb 0:1 $loadaddr Image
U-Boot &gt; fatload usb 0:1 $fdt_addr device-tree.dtb
U-Boot &gt; booti $loadaddr - $fdt_addr
</code></pre>
</li>
</ul>
<h1 id="5-manufacturing-tool-mfgtool">5. Manufacturing Tool, MFGTool</h1>
<p>MFGTool cung cấp khả năng boot thông qua USB Download Protocol. Các recipes để build manufacturing tool image là <em>linux-imx-mfgtool</em> và <em>u-boot-mfgtool</em>.</p>
<p>Để buld manufacturing tool, chạy lệnh:</p>
<pre><code>$ bitbake fsl-image-mfgtool-initramfs
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Vu Tang.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.2b46852b.min.js"></script>
      
    
  </body>
</html>